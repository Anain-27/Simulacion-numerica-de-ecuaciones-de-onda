% !TeX encoding = ISO-8859-1
\chapter{Conceptos previos}
\label{cha:preliminares}


Para facilitar la comprensión del tema que vamos a tratar hay varios conceptos que debemos explicar con anterioridad, en ello nos centraremos en este capítulo.





\section{Espacios de Lebesgue}

Comenzaremos definiendo los espacios de Lebesgue. Un concepto clásico que se utiliza de manera recurrente en varios campos de las matemáticas \citep{royden2010real}.

\begin{definicion}[label={Lebesgue},nameref={Title or anything else}]{Espacio de Lebesgue}
	Para $E\subset \mathbb{R}^n$, con $n\in\mathbb{N}$,
	 medible y $p\in \mathbb{R}$ tal que  $1\leq p < \infty$, definimos el Espacio de Lebesgue $L^p(E)$, como la colección de funciones medibles, en la que se realiza una identificación entre las funciones que son iguales en casi todo, que son $p$-integrables, es decir, las funciones $f$ para las cuales 
	\begin{equation}\label{normaLp}
		||f||_{L^p(E)}=\left(\int_{E}|f|^p\right)^{\frac{1}{p}}<\infty.
	\end{equation}
	
\end{definicion}

En lo que sigue del trabajo trabajaremos sobre este tipo de espacios. Sigamos viendo qué características tendrán.

\begin{definicion}[label={Banach},nameref={Title or anything else}]{Espacio de Banach}
	Un espacio de Banach $(E,||\cdot||)$ es un espacio vectorial normado, en el que $E$ es completo bajo la métrica inducida por la norma $||\cdot||$. Es decir, cada serie de Cauchy en $E$ es una serie convergente.
	
\end{definicion}
Por lo tanto, tomando $||f||_{L^p(E)}$ como la norma asociada a $L^p(E)$, este será un espacio de Banach.\\
Para que un espacio de Banach sea espacio de Hilbert, será necesario que tenga un producto asociado. Definamos este concepto.

\begin{definicion}[label={Escalar},nameref={Title or anything else}]{Producto escalar o interno.}
	Sea $E$ un espacio vectorial. Una función $(\cdot,\cdot):E\times E\rightarrow \mathbb{R} $ se llamará producto escalar o interno, si para todo $u,v,w\in E$ y  $\alpha, \beta \in \mathbb{R}$ escalares, se satisfacen las siguientes propiedades:
	\begin{itemize}
		\item Linealidad: $ (\alpha u+\beta v,w)= \alpha(u,w)+\beta(v,w)$ .
		\item Simetría: $ (u,v)=(v,u)$ .
		\item Positividad: $ (u,u)\geq 0$ , y $ (u,u)=0$  si y solo si $u=0$ .
		
	\end{itemize}
	
\end{definicion}

Así mismo, un espacio de Hilbert será:


\begin{definicion}[label={Hilbert},nameref={Title or anything else}]{Espacio de Hilbert}
	Un espacio de Banach $E$, se llama de Hilbert, si tiene un producto escalar asociado y es completo bajo su métrica.
	
\end{definicion}








\section{Producto escalar y suma por partes en $L^2$}
En nuestro caso trabajaremos sobre $L^2(E)$, que es un espacio de Hilbert con el siguiente producto escalar:



\begin{definicion}[label={Inner},nameref={Title or anything else}]{Producto escalar en $L^2$}
	Sean $f$ y $g$ dos funciones definidas en $E$, definimos el producto escalar sobre $L^2(E)$ de ellas como:
	$$\left< f,g\right>_{L^2(E)}= \int_{E}f(x)g(x)dx.$$
	
	
\end{definicion}

 Utilizaremos la norma inducida por este producto escalar. Esta se corresponderá con la norma definida por \ref{normaLp}.
 Para funciones que dependen de más de una variable, como por ejemplo del espacio y el tiempo, $u(x,t)$, fijando un instante t, quedará:

\begin{equation}\label{innermallado}
	\begin{split}
		\langle u_1(\cdot,t),u_2(\cdot,t)\rangle_{L^2(E)}&= \int_{E}u_1(x,t)u_2(x,t)dx,\\
		||u(\cdot,t)||_{L^2(E)}& = \sqrt{\left< u(x,t),u(x,t)\right>_{L^2(E)}}.
	\end{split}	
\end{equation}

A partir de ahora lo denotaremos como $\left< u_1,u_2\right>_{L^2(E)}$ y $||u||_{L^2(E)}$, respectivamente.\\


En este punto, nuestro objetivo será la definición de un producto escalar \ref{Escalar}, para una subdivisión, o mallado, de nuestro dominio. Ya que, lo usaremos en la sección \ref{energiadiscreta}. Para ello, vamos a definamos tal mallado, de la misma forma que lo utilizaremos en capítulos posteriores.


\begin{definicion}[label={Mallado},nameref={Title or anything else}]{Mallado}
	Sea $[a,b]\times[c,d]$ con $b\ge a,d\ge c$ y sean $n,m\in \mathbb{N}$. Definimos $h$ como tamaño del mallado en espacio y el paso de tiempo $k$, de forma que los puntos de nuestro mallado serán:
	$$(x,t)_{j.r}=(x_j,t_r), \ \ \  \text{donde}$$
	$$\begin{array}{lcc}   
		x_j=jh & para &  j=0,1,\dots,m,\\
		t_r = rk & para & r=0,1,\dots,n.\\
		
	\end{array} $$
	
\end{definicion}

Vemos que nuestro mallado sería del tipo:

\begin{figure}[!ht]
	\centering
	\includegraphics[scale=0.6]{mallado.png}
	\caption{Mallado}
\end{figure}
Una vez definido este mallado retomemos la definición del producto escalar para los puntos del mismo.\\

Siguiendo la definición de producto escalar de \cite{TimeDependent}. Puesto que queremos utilizar el producto escalar sobre una partición del interior del intervalo espacial $[a,b]$, el cual utilizando nuestro mallado queda $D=\{ x_1,\dots,x_{m-1}\}$, definiremos el producto escalar sobre $\mathbb{R}^{m-1}$.

\begin{definicion}[label={ProductoDiscreto},nameref={Title or anything else}]{Producto escalar en dominios discretos}
	Sean $u$ y $w$ dos funciones definidas en nuestro mallado y sea $D=\{ x_1,\dots,x_{m-1}\}$. 
	Fijando un instante temporal $t_r$, definimos el producto escalar sobre $\mathbb{R}^{m-1}$ como:
	\begin{equation}\label{eq:interiordiscretomalla}
		\left(u(\cdot,t_r),w(\cdot,t_r)\right)_{D}= \sum_{j=1}^{m-1}h u(x_j,t_r)w(x_j,t_r),
	\end{equation}
	Para este tipo de casos usaremos la siguiente notación:
	
	\begin{equation}\label{eq:notacioninteriordiscretomalla}
		\left(u_{\cdot,r},w_{\cdot,r}\right)_{D}= \sum_{j=1}^{m-1}h u_{j,r}w_{j,r}.
	\end{equation}

	La norma asociada a este producto escalar es:
	$||u||_{D}= \sqrt{\left( u,u\right)_D}\geq 0$.
\end{definicion}
El producto interior discreto, usualmente no está definido expresamente en un mallado, pero, ya que este será el contexto en el que lo utilizaremos a lo largo de el trabajo, es conveniente definirlo sobre el mismo.\\
Una vez definidas las operaciones que nos harán falta a lo largo del trabajo,  y para simplificar la notación que usaremos, necesitaremos los siguientes conceptos:
\begin{definicion}[label={shift},nameref={asjajsa}]{Desplazamiento progresivo y regresivo}
	Sean $u$ una función discretizada en el mallado antes descrito. Definiremos el  desplazamiento hacia delante (resp. desplazamiento hacia atrás) como:
	\begin{center}
		$e_{x+}u_{j,r}=u_{j+1,r},$\hspace{1cm} $\ \text{(}e_{x-}u_{j,r}=u_{j-1,r}$ respectivamente.)
	\end{center}
\end{definicion}
Continuando con este concepto podríamos aproximar la derivada de primer orden de la siguiente forma.
\begin{definicion}[label={defdelta},nameref={Title or anything else}]{Aproximaciones progresivas$\text{,}$ regresivas y centradas}
	
	Sea $u$ una función discretizada en un mallado como el la definición \ref{Mallado}.\\ Definiremos las diferencias aproximadas hacia adelante, atrás o centradas (más conocidas como \textit{Forward}, \textit{backward} y  \textit{centered difference approximations}) respectivamente, como:
	\begin{itemize}
		\item $\delta_{x^+}u_{j,r}= \frac{1}{h}\left(u_{j+1,r}-u_{j,r}\right)$, 
		\item $\delta_{x^-}u_{j,r}=\frac{1}{h}\left(u_{j,r}-u_{j-1,r}\right)$, 
		\item $\delta_{x}u_{j,r}= \frac{1}{2h}\left(u_{j+1,r}-u_{j-1,r}\right)$. 
	\end{itemize}
	Podemos hacer lo mismo para el eje temporal, denotándolas como $\delta_{t^+},\delta_{t^-},\delta_{t}$
\end{definicion}
Para aproximar la derivada de segundo orden definimos,
\begin{definicion}[label={derivada2},nameref={Title or anything else}]{Aproximación centrada de la derivada de segundo orden}
	Sea $u$ una función discretizada en un mallado como el de la definición \ref{Mallado}.\\ Definimos la aproximación centrada de la derivada de segundo orden como:
	
	\begin{equation*}
		\begin{split}
			\delta_{xx}u_{j,r}&=\frac{1}{h^2}\left(e_{x^+}u_{j,r}-2u_{j,r}+e_{x^-}u_{j,r}\right)=\\
			&=\frac{1}{h^2}\left(u_{j+1,r}-2u_{j,r}+u_{j-1,r}\right)
		\end{split}
	\end{equation*} 
	Al igual que la definición anterior esto será análogo en el eje temporal.
\end{definicion}

Veamos ahora la relación que guarda este concepto con \ref{defdelta}.
\begin{lema}[label={relacionderivada2},nameref={Title or anything else}]{Relación entre las diferencias aproximadas de segundo orden}
	Sean $u$, una función definida en el mallado \ref{Mallado}. Fijando un instante temporal $r$, se cumplirá la igualdad:
	\begin{equation}\label{eq:relacionxx}
		\delta_{xx} u_{j,r}=\delta_{x^+}\delta_{x^-}u_{j,r}=\delta_{x^-}\delta_{x^+}u_{j,r}
	\end{equation}
\end{lema}


\begin{proof}
	Comencemos por la primera igualdad:
	\begin{equation*}
		\begin{split}
			\delta_{x^+}(\delta_{x^-}(u_{j,r}))&= \delta_{x^+}(\frac{1}{h}\left(u_{j,r}-u_{j-1,r}\right))\\
			&=\frac{1}{h}\left(\delta_{x^+}u_{j,r}-\delta_{x^+}u_{j-1,r}\right)\\
			&=\frac{1}{h}\left(\frac{1}{h}\left(u_{j+1,r}-u_{j,r}\right)-\frac{1}{h}\left(u_{j,r}-u_{j-1,r}\right)\right)\\
			&=\frac{1}{h^2}\left(u_{j+1,r}-2u_{j,r}+u_{j-1,r}\right)\\
			&=\delta_{xx}u_{j,r},
		\end{split}
	\end{equation*}
	
	Continuando con el otro lado de la igualdad:
	\begin{equation*}
		\begin{split}
			\delta_{x^-}(\delta_{x^+}(u_{j,r}))&= \delta_{x^-}(\frac{1}{h}\left(u_{j+1,r}-u_{j,r}\right))\\
			&=\frac{1}{h}\left(\delta_{x^-}u_{j+1,r}-\delta_{x^-}u_{j,r}\right)\\
			&=\frac{1}{h}\left(\frac{1}{h}\left(u_{j+1,r}-u_{j,r}\right)-\frac{1}{h}\left(u_{j,r}-u_{j-1,r}\right)\right)\\
			&=\frac{1}{h^2}\left(u_{j+1,r}-2u_{j,r}+u_{j-1,r}\right)\\
			&=\delta_{xx}u_{j,r}.
		\end{split}
	\end{equation*} 
	Por lo tanto, podemos concluir que la posición de $\delta_{x^+}$ y $\delta_{x^-}$ en este contexto es intercambiable, es decir, $	\delta_{xx}u_{j,r}=  \delta_{x^+}(\delta_{x^-}(u_{j,r}))=\delta_{x^-}(\delta_{x^+}(u_{j,r})) $.\\
\end{proof}

Para finalizar la sección, hay otro concepto que tendremos que introducir. Este nos ayudará a hacer una representación discreta de la integración por partes. 
\begin{lema}[label={SumaPartes},nameref={Title or anything else}]{Representación de la suma por partes}
	Sean $u$, $w$ funciones definidas en el mallado \ref{Mallado} y sea $D=\{x_1,\dots,x_m-1\}$,una partición del interior del intervalo [a,b], tal y como en la definición \ref{ProductoDiscreto}. La representación de la suma por partes utilizando el producto escalar es, fijando un instante temporal $r$:
	
	\begin{equation}\label{eq:rep1}
		\left(u_{\cdot,r},\delta_{x^+}w_{\cdot,r}\right)_{D}=-\left(\delta_{x^-}u_{\cdot,r},w_{\cdot,r}\right)_{D} + u_{m-1,r}w_{m,r}-u_{0,r}w_{-1,r}
	\end{equation}
	
	\begin{equation}\label{eq:rep2}
		\left(u_{\cdot,r},\delta_{x^-}w_{\cdot,r}\right)_{D}= -\left(\delta_{x^+}u_{\cdot,r},w_{\cdot,r}\right)_{D}-u_{1,r}w_{0,r}+u_{m,r}w_{m-1,r}.
	\end{equation}
	
\end{lema}

\begin{proof}
	Por un lado, vemos que, 
	\begin{equation*}
		\begin{split}
			\left(u_{\cdot,r},\delta_{x^+}w_{\cdot,r}\right)_{D}&= \sum_{j=1}^{m-1}h u_{j,r}\frac{1}{h}\left(w_{j+1,r}-w_{j,r}\right)=\\
			&=-\sum_{j=1}^{m-1}h \frac{1}{h}\left(u_{j,r}-u_{j-1,r}\right)w_{j,r} +u_{m-1,r}w_{m,r}-u_{0,r}w_{1,r}=\\
			&=-\left(\delta_{x^-}u_{\cdot,r},w_{\cdot,r}\right)_{D} +u_{m-1,r}w_{m,r}-u_{0,r}w_{1,r}.
		\end{split}
	\end{equation*}
	
	Por otro lado, de manera análoga,
	\begin{equation*}
		\begin{split}
			\left(u_{\cdot,r},\delta_{x^-}w_{\cdot,r}\right)_{D}&= \sum_{j=1}^{m-1}h u_{j,r}\frac{1}{h}\left(w_{j,r}-w_{j-1,r}\right)=\\
			&=-\sum_{j=1}^{m-1}h \frac{1}{h}\left(u_{j+1,r}-u_{j,r}\right)w_{j,r} -u_{1,r}w_{-0,r}+u_{m,r}w_{m-1,r}=\\
			&=-\left(\delta_{x^+}u_{\cdot,r},w_{\cdot,r}\right)_{D}-u_{1,r}w_{0,r}+u_{m,r}w_{m-1,r}.
		\end{split}
	\end{equation*}	

\end{proof}

Al igual que en la definición \ref{ProductoDiscreto}, el lema \ref{SumaPartes}, se podría dar en $D'=\{x_0,\dots x_m\}$, pero utilizando como ejemplo \eqref{eq:rep1}, nos quedaría 
\begin{equation}\label{eq:nodovirtual}
	\left(u_{\cdot,r},\delta_{x^+}w_{\cdot,r}\right)_{D'}=-\left(\delta_{x^-}u_{\cdot,r},w_{\cdot,r}\right)_{D'} + u_{m,r}w_{m+1,r}-u_{-1,r}w_{0,r},
\end{equation}
podemos observar que en los últimos términos, $ u_{m,r}w_{m+1,r}$ y $u_{-1,r}w_{0,r}$ quedan fuera del mallado definido, estos se llaman puntos virtuales del mallado. Los utilizaremos en la sección \ref{energiadiscreta}.



